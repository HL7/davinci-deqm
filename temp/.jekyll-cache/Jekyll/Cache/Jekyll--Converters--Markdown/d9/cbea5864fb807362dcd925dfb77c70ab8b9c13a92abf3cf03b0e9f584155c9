I"¨Æ
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#introduction" id="markdown-toc-introduction">Introduction</a></li>
  <li><a href="#profiles" id="markdown-toc-profiles">Profiles</a></li>
  <li><a href="#data-exchange" id="markdown-toc-data-exchange">Data Exchange</a>    <ul>
      <li><a href="#submit-data" id="markdown-toc-submit-data">Submit Data</a></li>
      <li><a href="#collect-data" id="markdown-toc-collect-data">Collect Data</a></li>
      <li><a href="#submit-data-and-collect-data-for-multiple-patients" id="markdown-toc-submit-data-and-collect-data-for-multiple-patients">Submit Data and Collect Data for Multiple Patients</a></li>
      <li><a href="#provenance" id="markdown-toc-provenance">Provenance</a></li>
    </ul>
  </li>
</ul>

</div>

<h2 id="introduction">Introduction</h2>

<p>Clinical Quality Measures (CQMs) are a common tool used throughout healthcare to help evaluate and understand the impact and quality of the care being provided to an individual or population. The intent of <a href="index.html#data-of-interest">data of interest</a> is the source data needed to calculate a quality measure, as specified by the data requirements of the measure. For example, for a colorectal cancer screening measure, the data of interest is the set of conditions, procedures, and observations related to determining whether a patient is in the initial population, denominator, and numerator of the quality measure. To effectively evaluate quality measures in such an environment requires timely exchange of the relevant data.</p>

<p>Transactions between Consumers (organizations that want to evaluate quality measures) and Producers (organizations that deliver care to patients) are triggered by use case specific clinical or administrative events such as the completion of a Medication Reconciliation or a request from a Payer for the attestation information. Note that although triggering is implementation specific and out of scope for this IG,  there are a variety of potential triggering points for reporting events within clinical systems.  These include:</p>

<ul>
  <li><a href="http://www.openinfobutton.org/">Infobutton</a> event listing</li>
  <li><a href="http://www.hl7.org/fhir/us/ecr/history.cfml">eCR</a> Event Types</li>
  <li><a href="https://cds-hooks.org/">CDS Hooks</a> Hook definitions</li>
  <li><a href="http://www.hl7.org/fhir/uv/cpg/history.cfml">CPG-on-FHIR</a> common processes</li>
</ul>

<p>and there will be a need to convey triggering information in a computable way to EHRs and other clinical systems.</p>

<p>This Implementation Guide (IG) describes three methods of exchanging data quality information using a set of <a href="http://hl7.org/fhir/R4/operations.html" title="Extended Operations on the RESTful API">FHIR operations</a> that provide the framework to exchange CQM data:</p>

<ol>
  <li>CQM data may be submitted to the Consumer by the Producer using the <a href="#submit-data">Submit Data scenario</a></li>
  <li>CQM data may be requested from the Producer by the Consumer using the <a href="#collect-data">Collect Data scenario</a></li>
</ol>

<p>Note that FHIR operations allow the implementation to be viewed as a ‚Äòblack box‚Äô free to decide how to satisfy the query - ‚Äúgive me the data of interest for a measure‚Äù - without requiring generic FHIR search functionality.</p>

<p class="stu-note">This project recognizes the impact of the <a href="https://argonautwiki.hl7.org/Argonaut_2019_Projects#Clinical_Data_Subscriptions">Argonaut Clinical Data Subscriptions</a> project which is working on event based subscriptions and major revisions to the Subscription resource for FHIR R5. In a future version this guide, a subscription based exchange <!-- in which the Consumer may subscribe to a Producer's Subscription service to be notified when the CQM data is available --> is planned and will align with the outcomes of the Argonaut project.</p>

<h2 id="profiles">Profiles</h2>

<p>The following resources are used in all data exchange transactions:</p>

<table>
  <thead>
    <tr>
      <th>Resource Type</th>
      <th>Profile Name</th>
      <th>Link to Profile</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Library</td>
      <td>CQFM Library Profile</td>
      <td><a href="http://hl7.org/fhir/us/cqfmeasures/StructureDefinition-library-cqfm.html">CQFM Library</a></td>
    </tr>
    <tr>
      <td>Measure</td>
      <td>CQFM Measure Profile</td>
      <td><a href="http://hl7.org/fhir/us/cqfmeasures/StructureDefinition-measure-cqfm.html">CQFM Measure</a></td>
    </tr>
    <tr>
      <td>MeasureReport</td>
      <td>DEQM Data Exchange MeasureReport Profile</td>
      <td><a href="StructureDefinition-datax-measurereport-deqm.html">DEQM Data Exchange MeasureReport Profile</a></td>
    </tr>
    <tr>
      <td>Organization</td>
      <td>DEQM Organization Profile</td>
      <td><a href="StructureDefinition-organization-deqm.html">DEQM Organization</a></td>
    </tr>
    <tr>
      <td>Patient</td>
      <td>QI Core Patient Profile</td>
      <td><a href="http://hl7.org/fhir/us/qicore/StructureDefinition-qicore-patient.html">QI Core Patient</a></td>
    </tr>
  </tbody>
</table>

<p>Depending on the specific Measure, various DEQM and QI Core Profiles are also used in addition to the profiles listed above</p>

<h3 class="no_toc" id="graph-of-deqm-resources">Graph of DEQM Resources</h3>

<p>The DEQM resources form a network through their relationships with each other - either through a direct reference to another resource or through a chain of intermediate references. These groups of resources are referred to as resources graphs.  The DEQM data exchange resource graph is shown in Figure 2-1:</p>

<!-- all this Bootstrap html for getting an narrow image to fit nicely in text - 640 pix wide -->

<div>
  <figure class="figure">
    <figcaption class="figure-caption">
      <p><strong>Figure 2-1 DEQM Resource Graph</strong>&lt;/figcaption&gt;
  <img src="measure-resource-graph.svg" class="figure-img img-responsive img-rounded center-block" alt="measure-resource-graph.svg" />
&lt;/figure&gt;</p>

      <p></p>
      <p>&lt;/div&gt;</p>

      <h2 id="data-exchange">Data Exchange</h2>

      <h3 id="submit-data">Submit Data</h3>

      <p class="highlight-note">The <a href="http://hl7.org/fhir/R4/measure-operation-submit-data.html" title="The effect of invoking this operation is to gather the data required to perform an evaluation of the measure.">$submit-data</a> operation allows a Producer to submit data of interest for a particular quality measure within the specified <a href="index.html#submission-period">submission period</a>.  The operation MAY be repeated during the submission period as additional data relevant to the quality measure becomes available.  The Producer submits the data either as  <a href="index.html#incremental-update">incremental</a> or <a href="index.html#snapshot-update">snapshot</a> updates. These update methods are described in detail <a href="#submit-updates">below</a>.</p>

      <!-- all this Bootstrap html for getting an narrow image to fit nicely in text - 640 pix wide -->

      <div>
        <figure class="figure">
          <figcaption class="figure-caption">
            <p><strong>Figure 2-2 Submit Data Steps</strong>&lt;/figcaption&gt;
  <img src="submit-data-step.jpg" class="figure-img img-responsive img-rounded center-block" alt="submit-data-step.jpg" />
&lt;/figure&gt;</p>

            <p></p>
            <p>&lt;/div&gt;</p>

            <h4 class="no_toc" id="gather-data-requirements-from-consumer">Gather Data Requirements from Consumer</h4>

            <p>To support the Submit Data operation, an implementation needs to know specifically what data are required to provide as the payload for the operation.  As described in the <a href="index.html#background">Background</a> section of this guide, the profiles used in measuring and reporting CQMs are developed through a multi-stakeholder consensus-based process and are made available to the Producer.  The Producer is able to query for profiles needed for reporting a given measure and the criteria for the sending of the data.  This can be done manually by reviewing the measure definition or computationally by invoking the <em>Data Requirements</em> operation on a Consumer‚Äôs measure instance endpoint as described below. These profiles are subsequently referenced in the <code class="highlighter-rouge">MeasureReport.evaluatedResources</code> element when submitting the measure data to the Consumer.</p>

            <p>Note that because the data exchange scenarios described are intended to support exchange throughout a measurement period, the versions of measure specifications may change during the measurement period. Care should be taken to ensure the appropriate versioning of measure specifications and the impact of those changes on data exchanged using these methods</p>

            <!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

            <div>
              <figure class="figure">
                <figcaption class="figure-caption">
                  <p><strong>Figure 2-3 Data Requirements Operation</strong>&lt;/figcaption&gt;
  <img src="data-requirement.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="data-requirement.jpg" />
&lt;/figure&gt;</p>

                  <p></p>
                  <p>&lt;/div&gt;</p>

                  <h5 class="no_toc" id="apis">APIs</h5>

                  <p>In addition to the resources listed above, the following artifacts are used in this transaction:</p>

                  <ol>
                    <li>Data Requirements: <a href="http://hl7.org/fhir/R4/measure-operation-data-requirements.html" title="The data-requirements operation aggregates and returns the parameters and data requirements for the measure and all its dependencies as a single module definition">$data-requirements</a> operation</li>
                  </ol>

                  <h5 class="no_toc" id="usage">Usage</h5>

                  <p>The required data for each Measure is discovered by invoking the <em>Data Requirements</em> operation on the Consumer‚Äôs <code class="highlighter-rouge">Measure/[measure-id]</code> endpoint.  Using either the <code class="highlighter-rouge">GET</code> or <code class="highlighter-rouge">POST</code> Syntax, the operation can be invoked as follows:</p>

                  <p><code class="highlighter-rouge">GET|[base]/Measure/[measure-id]/$data-requirements?periodStart={periodStart}&amp;periodEnd={periodEnd}</code></p>

                  <p><code class="highlighter-rouge">POST|[base]/Measure/[measure-id]/$data-requirements</code></p>

                  <p>Note the use of the <code class="highlighter-rouge">periodStart</code> and <code class="highlighter-rouge">periodEnd</code> parameters supports description of data requirements that filter based on the measurement period. For example, a measure may require data for a certain procedure within the last three years, and the data requirements returned will reflect that period.</p>

                  <p>
  <button class="btn btn-info btn-lg" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#data-requirements-example" aria-expanded="false" aria-controls="collapseExample">
    Click Here To See Example Data Requirements operation
  </button>
</p>

                  <div class="collapse" id="data-requirements-example">
                    <div class="card card-body">
                      <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;h3 class="no_toc" id="example"&gt;Example&lt;/h3&gt;
</code></pre></div>                      </div>

                      <p><strong>Scenario</strong></p>

                      <p>Provider X acting in the role of the Producer requests data requirements for the MRP measure from Payer Z which is acting in the role of Consumer.  A Library resource containing the required resources for MRP attestation returned on successful evaluation.</p>

                      <p><strong>Request using <code class="highlighter-rouge">GET</code></strong></p>

                      <p><code class="highlighter-rouge">GET [base]/Measure/measure-mrp/$data-requirements?periodStart=2018&amp;periodEnd=2018</code></p>

                      <p><strong>Request using <code class="highlighter-rouge">POST</code></strong></p>

                      <p><code class="highlighter-rouge">POST [base]/Measure/measure-mrp/$data-requirements</code></p>

                      <p><strong>Request body</strong></p>

                      <div class="highlighter-rouge">
                        <div class="highlight">
                          <pre class="highlight"><code>{
   "resourceType":"Parameters",
   "parameter":[
      {
         "name":"periodStart",
         "valueDate":"2018"
      },
      {
         "name":"periodEnd",
         "valueDate":"2018"
      }
    ]
 }
</code></pre>
                        </div>
                      </div>

                      <p><strong>Response</strong></p>

                      <div class="highlighter-rouge">
                        <div class="highlight">
                          <pre class="highlight"><code>HTTP/1.1 200 OK
[other headers]
</code></pre>
                        </div>
                      </div>

                      <p><strong>Response body</strong></p>

                      <div class="highlighter-rouge">
                        <div class="highlight">
                          <pre class="highlight"><code>{
  "resourceType": "Library",
  "id": "library-mrp-example",
  "text": {
    "status": "generated",
    "div": "&lt;div xmlns=\"http://www.w3.org/1999/xhtml\"&gt;&lt;p&gt;&lt;b&gt;Generated Narrative&lt;/b&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;id&lt;/b&gt;: library-mrp-example&lt;/p&gt;&lt;p&gt;&lt;b&gt;url&lt;/b&gt;: &lt;a href=\"http://hl7.org/fhir/us/davinci-deqm/Library/library-mrp-example\"&gt;http://hl7.org/fhir/us/davinci-deqm/Library/library-mrp-example&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;version&lt;/b&gt;: 1.1.0&lt;/p&gt;&lt;p&gt;&lt;b&gt;name&lt;/b&gt;: DEQMLibraryMRPExample&lt;/p&gt;&lt;p&gt;&lt;b&gt;title&lt;/b&gt;: DEQM Library MRP Example&lt;/p&gt;&lt;p&gt;&lt;b&gt;status&lt;/b&gt;: active&lt;/p&gt;&lt;p&gt;&lt;b&gt;type&lt;/b&gt;: &lt;span title=\"Codes: {http://terminology.hl7.org/CodeSystem/library-type module-definition}\"&gt;Module Definition&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;date&lt;/b&gt;: Jun 19, 2020, 10:44:16 AM&lt;/p&gt;&lt;p&gt;&lt;b&gt;publisher&lt;/b&gt;: HL7 International - Clinical Quality Information Work Group&lt;/p&gt;&lt;p&gt;&lt;b&gt;contact&lt;/b&gt;: http://www.hl7.org/Special/committees/cqi/index.cfm&lt;/p&gt;&lt;p&gt;&lt;b&gt;description&lt;/b&gt;: Example Library resource to demonstrate the framework for MRP&lt;/p&gt;&lt;p&gt;&lt;b&gt;jurisdiction&lt;/b&gt;: &lt;span title=\"Codes: {urn:iso:std:iso:3166 US}\"&gt;United States of America&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;dataRequirement&lt;/b&gt;: , , , , , , &lt;/p&gt;&lt;/div&gt;"
  },
  "url": "http://hl7.org/fhir/us/davinci-deqm/Library/library-mrp-example",
  "version": "1.1.0",
  "name": "DEQMLibraryMRPExample",
  "title": "DEQM Library MRP Example",
  "status": "active",
  "type": {
    "coding": [
      {
        "system": "http://terminology.hl7.org/CodeSystem/library-type",
        "code": "module-definition"
      }
    ]
  },
  "date": "2020-06-19T10:44:16-07:00",
  "publisher": "HL7 International - Clinical Quality Information Work Group",
  "contact": [
    {
      "telecom": [
        {
          "system": "url",
          "value": "http://www.hl7.org/Special/committees/cqi/index.cfm"
        }
      ]
    }
  ],
  "description": "Example Library resource to demonstrate the framework for MRP",
  "jurisdiction": [
    {
      "coding": [
        {
          "system": "urn:iso:std:iso:3166",
          "code": "US"
        }
      ]
    }
  ],
  "dataRequirement": [
    {
      "type": "MeasureReport",
      "profile": [
        "http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/datax-measurereport-deqm"
      ]
    },
    {
      "type": "Patient",
      "profile": [
        "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-patient"
      ]
    },
    {
      "type": "Encounter",
      "profile": [
        "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter"
      ]
    },
    {
      "type": "Location",
      "profile": [
        "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-location"
      ]
    },
    {
      "type": "Task",
      "profile": [
        "http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-task"
      ]
    },
    {
      "type": "Organization",
      "profile": [
        "http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/organization-deqm"
      ]
    },
    {
      "type": "Practitioner",
      "profile": [
        "http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/practitioner-deqm"
      ]
    }
  ]
}
</code></pre>
                        </div>
                      </div>

                    </div>
                  </div>

                  <p>For another example see the <a href="col.html#data-requirements">COL Data Requirements Operation</a> example.</p>

                  <h4 class="no_toc" id="submit-data-operation">Submit Data Operation</h4>

                  <p>Once the Producer understands the data requirements, they will use the <em>Submit Data</em> operation to submit a MeasureReport and the referenced resources as discovered by the <em>Data Requirements</em> operation to the Consumer. There is no expectation that the submitted data represents all the data of interest, only that all the data submitted is relevant to the calculation of the measure for a particular subject or population. The Consumer simply accepts the submitted data and there is no expectation that the Consumer will actually evaluate the quality measure in response to every Submit Data. In addition, the Submit Data operation does not provide for analytics or feedback on the submitted data.</p>

                  <!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

                  <div>
                    <figure class="figure">
                      <figcaption class="figure-caption">
                        <p><strong>Figure 2-4 Submit data Operation</strong>&lt;/figcaption&gt;
  <img src="submit-data.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="submit-data.jpg" />
&lt;/figure&gt;</p>

                        <p></p>
                        <p>&lt;/div&gt;</p>

                        <div class="highlight-note">

                          <h5 class="no_toc" id="submit-updates">Incremental and Snapshot Updates</h5>

                          <p>When the Producer submits updates to the measure data within the data submission period, the Producer can use <a href="index.html#snapshot-update">snapshot</a> or <a href="index.html#incremental-update">incremental</a> updates for submitting data based on Producer and Consumer agreement.  Note that neither method is preferred or a default and has to be agreed upon out of band.</p>

                          <p>Examples of patient ‚Äòevents‚Äô that could trigger the submission of an update:</p>

                          <ul>
                            <li>A visit, including telemedicine, to a physician‚Äôs office.</li>
                            <li>Being discharged from a hospital.</li>
                          </ul>

                          <p><strong>Discovery:</strong></p>

                          <ul>
                            <li>
                              <p>The Consumer <strong>SHALL</strong> advertise whether it supports snapshot or incremental data exchange via its CapabilityStatement using the <a href="StructureDefinition-extension-submitDataUpdateType.html">DEQM Submit Data Update Type Extension</a>.  Specifically by applying the extension to the <code class="highlighter-rouge">CapabiltityStatement.rest.resource.operation</code> element for the Submit Data operation and populating the value the code <code class="highlighter-rouge">incremental</code> or <code class="highlighter-rouge">snapshot</code> as shown below:</p>

                              <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
  "resource": [
{
  "type": "Measure",
  "supportedProfile": [
    "http://hl7.org/fhir/us/cqfmeasures/StructureDefinition/measure-cqfm"
  ],
  "interaction": [
    {
      "code": "read"
    }
  ],
  "operation": [
    {
      "name": "submit-data",
      "definition": "http://hl7.org/fhir/OperationDefinition/Measure-submit-data"
    },
    {
      "extension": [
        {
          "url": "http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/extension-updateType",
          "valueCode": "incremental"
        }
      ]
    }
  ]
}
...snipped content...
  ]
}
</code></pre></div>                              </div>
                            </li>
                          </ul>

                          <p>(For a complete example, see the <a href="CapabilityStatement-consumer-server.json.html">Consumer Server CapabilityStatement</a> )</p>

                          <ul>
                            <li>
                              <p>It is the responsibility of the Producer to discover whether snapshot or incremental data exchange is supported by the inspection of the Consumer‚Äôs CapabilityStatement.</p>
                            </li>
                            <li>
                              <p>The required <a href="StructureDefinition-extension-submitDataUpdateType.html">DEQM Submit Data Update Type Extension</a> on the <a href="StructureDefinition-datax-measurereport-deqm.html">DEQM Data Exchange MeasureReport Profile</a> is used to indicate whether the payload is a snapshot or incremental update for both the initial transaction and subsequent updates.
(update examples to show this)**</p>
                            </li>
                            <li>
                              <p>The Consumer <strong>SHALL</strong> reject the submit data payload if there is mismatch between the Consumer‚Äôs stated capabilities and the  required modifier extension by returning a <code class="highlighter-rouge">400 Bad Request</code> http error code. An OperationOutcome <strong>SHOULD</strong> be returned stating that the [snapshot/incremental] update is not supported as shown in the following example:</p>

                              <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 400 Not Found
[other headers]
{
  "resourceType": "OperationOutcome",
  "id": "no-status",
  "issue": [
{
  "severity": "error",
  "code": "business-rule",
  "details": {
    "text": "Snapshot/Incremental update is not supported."
  },
  "diagnostics": "Resubmit the payload as a snapshot/incremental update and populate the extension http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/extension-dataa-updateType" with the code 'snapshot'/'incremental'"
}
  ]
}
</code></pre></div>                              </div>
                            </li>
                          </ul>

                          <p><strong>Incremental Update Requirements and Expectations:</strong></p>

                          <ul>
                            <li>
                              <p>For incremental data exchange, stable logical (resource) ids and meta.source elements are required for <em>ALL</em> transacted resources across <em>ALL</em> transactions.</p>

                              <ul>
                                <li>For example  <code class="highlighter-rouge">MeasureReport.id</code> + <code class="highlighter-rouge">MeasureReport.meta.source</code>, <code class="highlighter-rouge">Patient.id</code> + <code class="highlighter-rouge">Patient.meta.souce</code>, etc ‚Ä¶ must be the same for all data exchange interactions for a patient and measure during the submission period.</li>
                              </ul>
                            </li>
                            <li>
                              <p>Note that versions are of the resource can be accessed using the FHIR RESTful history transaction</p>
                            </li>
                          </ul>

                          <p><strong>Snapshot Update Requirements and Expectations:</strong></p>

                          <ul>
                            <li>
                              <p>Snapshot data exchange overwrites previous data ( in other words, the Producer resubmit all data for multiple patients even for a single error).</p>
                            </li>
                            <li>
                              <p>Snapshot data exchange is appropriate when the Consumer system is stateless (doesn‚Äôt persist data)</p>

                              <ul>
                                <li>Otherwise the Consumer may have to save previous snapshots</li>
                              </ul>
                            </li>
                            <li>
                              <p>Snapshot data exchange is appropriate when the Producer can‚Äôt support stable logical (resource) ids</p>
                            </li>
                          </ul>

                        </div>

                        <h5 class="no_toc" id="apis-1">APIs</h5>

                        <p>In addition to the resources listed above, the following artifacts are used in this transaction:</p>

                        <ol>
                          <li>Submit Data operation: <a href="http://hl7.org/fhir/R4/measure-operation-submit-data.html" title="The effect of invoking this operation is to gather the data required to perform an evaluation of the measure.">$submit-data</a></li>
                          <li>Various DEQM and QI Core Profiles depending on the specific Measure</li>
                        </ol>

                        <h5 class="no_toc" id="usage-1">Usage</h5>

                        <p>Using the <code class="highlighter-rouge">POST</code> Syntax, the operation can be invoked by the Producer:</p>

                        <p><code class="highlighter-rouge">POST|[base]/Measure/[measure-id]/$submit-data</code></p>

                        <p>
  <button class="btn btn-info btn-lg" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#submit-data-example" aria-expanded="false" aria-controls="collapseExample">
    Click Here To See Example Submit Data Operation (edited for brevity)
  </button>
</p>

                        <div class="collapse" id="submit-data-example">
                          <div class="card card-body">
                            <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;h3 class="no_toc" id="examples"&gt;Examples&lt;/h3&gt;
</code></pre></div>                            </div>

                            <p><strong>Scenario:</strong></p>

                            <p>Provider X acting in the role of Producer submits MRP data for Patient Y to Payer Z who is acting in the role of Consumer.  The body of the request is a Parameters resource containing the required profiles for MRP attestation using Task as the resource used to evaluate the measure.  An HTTP Status success code is returned on successful submission.</p>

                            <p><strong>Request using <code class="highlighter-rouge">POST</code></strong></p>

                            <p><code class="highlighter-rouge">POST [base]/Measure/measure-mrp/$submit-data</code></p>

                            <p><strong>Request body</strong></p>

                            <div class="highlighter-rouge">
                              <div class="highlight">
                                <pre class="highlight"><code>{
   "resourceType":"Parameters",
   "parameter":[
      {
         "name":"measurereport",
         "resource":"{"resourceType": "MeasureReport",
         ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Task",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Patient",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Location",
          ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Practitioner",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Organization",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Coverage",
        ...}
      },

    ]
 }
</code></pre>
                              </div>
                            </div>

                            <p><strong>Response</strong></p>

                            <div class="highlighter-rouge">
                              <div class="highlight">
                                <pre class="highlight"><code>HTTP/1.1 200 OK
[other headers]
</code></pre>
                              </div>
                            </div>

                          </div>
                        </div>

                        <p>For a complete un-edited example see the <a href="mrp.html#data-exchange-using-the-submit-data-operation">MRP Submit Data Operation</a> and <a href="col.html#submit-data">COL Submit Data Operation</a> examples.</p>

                        <h3 id="collect-data">Collect Data</h3>

                        <p>In this scenario, the Consumer initiates a <a href="http://hl7.org/fhir/R4/measure-operation-collect-data.html" title="The effect of invoking this operation is to gather the data required to perform an evaluation of the measure.">$collect-data</a> operation to gather any available CQM data for a particular measure from the Producer.  In response to the operation, the Producer returns a MeasureReport containing data relevant to the Measure. The Producer gathers the data requirements as <a href="#gather-data-requirements-from-consumer">described</a> above in the Submit Data scenario. Like the Submit Data scenario, there is no expectation that the data returned represents all the data required to evaluate the quality measure only that all the data submitted is relevant to the calculation of the measure for a particular subject or population.  Unlike the Submit Data interaction, the exchange is typically incremental as detailed <a href="#">below</a>.</p>

                        <!-- all this Bootstrap html for getting an narrow image to fit nicely in text - 640 pix wide -->

                        <div>
                          <figure class="figure">
                            <figcaption class="figure-caption">
                              <p><strong>Figure 2-5 Collect Data Steps</strong>&lt;/figcaption&gt;
  <img src="collect-data-steps.jpg" class="figure-img img-responsive img-rounded center-block" alt="collect-data-steps.jpg" />
&lt;/figure&gt;</p>

                              <p></p>
                              <p>&lt;/div&gt;</p>

                              <h4 class="no_toc" id="collect-data-operation">Collect Data Operation</h4>

                              <p>The Consumer uses a Collect Data operation to request any available relevant data for the evaluation of a particular measure from a Producer. Unlike the Submit Data interaction, the collect data exchange is typically incremental. This would typically be done on a periodic basis to support incremental collection of quality data. The <code class="highlighter-rouge">lastReceivedOn</code> parameter can be used to indicate when the last Collect Data operation was performed, allowing the Producer to limit the response to only data that has been entered or changed since the last received on date.</p>

                              <!-- all this Bootstrap html for getting an image to fit nicely in text - 640 pix wide -->

                              <div>
                                <figure class="figure">
                                  <figcaption class="figure-caption">
                                    <p><strong>Figure 2-6 Collect data Operation</strong>&lt;/figcaption&gt;
  <img src="collect-data.jpg" class="figure-img-narrow img-responsive img-rounded center-block" alt="collect-data.jpg" />
&lt;/figure&gt;</p>

                                    <p></p>
                                    <p>&lt;/div&gt;</p>

                                    <h5 class="no_toc" id="collect-updates">Incremental and Snapshot Updates</h5>

                                    <ul>
                                      <li>Unlike the Submit Data interaction, there is no need for out of band discovery.</li>
                                      <li>The Consumer uses the Collect Data operation‚Äôs <code class="highlighter-rouge">lastReceivedOn</code> parameter for incremental data exchange - if the  parameter present, it is an incremental update and snapshot if not.</li>
                                      <li>The same Snapshot and Incremental Requirements and Expectations described above for the Submit Data transaction apply for Collect Data.</li>
                                      <li>
                                        <p>If the Producer cannot support the lastReceivedOn parameter then it SHALL return a <code class="highlighter-rouge">400 Bad Request</code> http error code. An OperationOutcome <strong>SHOULD</strong> be returned stating that the <code class="highlighter-rouge">lastReceivedOn</code> parameter is not supported  as shown in the following example:</p>

                                        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>HTTP/1.1 400 Not Found
[other headers]
{
"resourceType": "OperationOutcome",
"id": "no-status",
"issue": [
  {
    "severity": "error",
    "code": "business-rule",
    "details": {
      "text": "The `lastReceivedOn` parameter is not supported "
    },
    "diagnostics": "Resubmit all the information in the payload as a snapshot update"
  }
]
}
</code></pre></div>                                        </div>
                                      </li>
                                    </ul>

                                    <h5 class="no_toc" id="apis-2">APIs</h5>

                                    <p>In addition to the resources listed above, the following artifacts are used in this transaction:</p>

                                    <ol>
                                      <li>Collect Data operation:<a href="http://hl7.org/fhir/R4/measure-operation-collect-data.html" title="The effect of invoking this operation is to gather the data required to perform an evaluation of the measure.">$collect-data</a></li>
                                      <li>Various DEQM and QI Core Profiles depending on the specific Measure</li>
                                    </ol>

                                    <h5 class="no_toc" id="usage-2">Usage</h5>

                                    <p><strong>Collect Data:</strong></p>

                                    <p>Using either the <code class="highlighter-rouge">GET</code> or <code class="highlighter-rouge">POST</code> Syntax, the operation can be invoked by the Consumer:</p>

                                    <p><code class="highlighter-rouge">GET|[base]/Measure/[measure-id]/$collect-data&amp;[parameters]</code></p>

                                    <p><code class="highlighter-rouge">POST|[base]/Measure/[measure-id]/$collect-data</code></p>

                                    <p>
  <button class="btn btn-info btn-lg" type="button" title="Click to Open or Close Example" data-toggle="collapse" data-target="#collect-data-example" aria-expanded="false" aria-controls="collapseExample">
    Click Here To See Example Collect Data operation
  </button>
</p>

                                    <div class="collapse" id="collect-data-example">
                                      <div class="card card-body">
                                        <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  &lt;h3 id="examples"&gt;Examples&lt;/h3&gt;
</code></pre></div>                                        </div>

                                        <p><strong>Scenario:</strong></p>

                                        <p>Payer Z acting in the role of the Consumer collect Patient Z‚Äôs MRP data from Provider X which is acting in role of the Producer</p>

                                        <p><strong>Request using GET Syntax</strong></p>

                                        <p><code class="highlighter-rouge">GET [base]/MeasureReport/measure-mrp/$collect-data?subject=Patient/patient-z&amp;provider=Practitioner/provider-x&amp;periodStart=2018-06-19</code></p>

                                        <p><strong>Request using POST Syntax</strong></p>

                                        <p><code class="highlighter-rouge">POST [base]/MeasureReport/measure-mrp/$collect-data</code></p>

                                        <p><strong>Request body</strong></p>

                                        <div class="highlighter-rouge">
                                          <div class="highlight">
                                            <pre class="highlight"><code>{
   "resourceType":"Parameters",
   "parameter":[
      {
         "name":"subject",
         "valueUri":"Patient/patient-z"
      },
      {
         "name":"practitioner",
         "valueUri":"Practitioner/provider-x"
      },
      {
         "name":"periodStart",
         "valueDate":"Practitioner/2018-06-19"
       }
    ]
 }
</code></pre>
                                          </div>
                                        </div>

                                        <p><strong>Response</strong></p>

                                        <div class="highlighter-rouge">
                                          <div class="highlight">
                                            <pre class="highlight"><code>HTTP/1.1 200 OK
[other headers]
</code></pre>
                                          </div>
                                        </div>

                                        <p><strong>Response body</strong></p>

                                        <div class="highlighter-rouge">
                                          <div class="highlight">
                                            <pre class="highlight"><code>{
   "resourceType":"Parameters",
   "parameter":[
      {
         "name":"measurereport",
         "resource":"{"resourceType": "MeasureReport",
         ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Task",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Patient",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Location",
          ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Practitioner",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Organization",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Encounter",
        ...}
      },
      {
        "name":"resource",
        "resource":"{"resourceType": "Coverage",
        ...}
      },

    ]
 }
</code></pre>
                                          </div>
                                        </div>

                                      </div>
                                    </div>

                                    <p>For a complete un-edited example see the <a href="col.html#collect-data">COL Collect Data Operation</a> example.</p>

                                    <h3 id="submit-data-and-collect-data-for-multiple-patients">Submit Data and Collect Data for Multiple Patients</h3>

                                    <h4 class="no_toc" id="submit-data-operation-request-for-multiple-patients">Submit Data Operation Request for Multiple Patients</h4>

                                    <p>The <a href="http://hl7.org/fhir/R4/http.html#transaction">transaction</a> bundle processing as defined by FHIR specification is used for transacting the body of Submit Data operation request for <em>multiple</em> patients in a single interaction.</p>

                                    <ul>
                                      <li>The transaction bundle contains an entry for each patient as illustrated in the examples below:
                                        <ul>
                                          <li>The fullUrl is a UUID (<code class="highlighter-rouge">urn:uuid:...</code>).</li>
                                          <li>The resource is a Parameters resource as defined in the operation.</li>
                                          <li>The request method is <code class="highlighter-rouge">POST</code></li>
                                          <li>The request url is the operation endpoint <code class="highlighter-rouge">Measure/$submit-data</code> or <code class="highlighter-rouge">Measure/[measure-id]/$submit-data</code>.</li>
                                        </ul>
                                      </li>
                                      <li>When resolving references, references are never resolved outside the Parameters resource.  Specifically, resolution stops at the elements Parameters.parameter.resource.‚Äù</li>
                                      <li>The matching <a href="http://hl7.org/fhir/R4/http.html#transaction-response">transaction response</a> is returned by the operation endpoint server.</li>
                                    </ul>

                                    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>POST|[base]

{
  "resourceType": "Bundle",
  "type": "transaction",
  "entry": [
    {
      "fullUrl": "urn:uuid:79378cb8-8f58-48e8-a5e8-60ac2755b674",
      "resource": {
        "resourceType": "Parameters",
        "parameter": [
          {
            "name": "measurereport",
            "resource": {
              "resourceType": "MeasureReport",
              ...,
            "name": "resource",
            "resource": {
              "resourceType": "Patient",
              ...,
            [other "resource" parameters]
          ]
        },
        "request": {
          "method": "POST",
          "url": "Measure/[measure-id]/$submit-data"
            }
            ....
</code></pre></div>                                    </div>

                                    <h4 class="no_toc" id="collect-data-operation-response-for-multiple-patients">Collect Data Operation Response for Multiple Patients</h4>

                                    <p>Because operations are typically executed synchronously, a collect data request to a server returns a Parameter resource for a <em>single</em> patient as defined by the <code class="highlighter-rouge">$collect-data</code> operation.  Execution of this operation and returning multiple patients in a single <em>asynchronous</em> transaction is outside the scope of this guide.</p>

                                    <h3 id="provenance">Provenance</h3>

                                    <p>Note that the use of the <a href="http://hl7.org/fhir/R4/provenance.html#header">X-Provenance header data</a> with provenance data that establishes provenance of the data being submitted/collected <strong>SHOULD</strong> be supported.  This provides the capability for associating the provider with the data submitted through the $submit-data and $collect-data transactions described above. If the X-Provenance header is used it should be consistent with the <code class="highlighter-rouge">reporter</code> element in the DEQM Data Exchange MeasureReport Profile.</p>

                                    <p><br /></p>

                                  </figcaption>
                                </figure>
                              </div>
                            </figcaption>
                          </figure>
                        </div>
                      </figcaption>
                    </figure>
                  </div>
                </figcaption>
              </figure>
            </div>
          </figcaption>
        </figure>
      </div>
    </figcaption>
  </figure>
</div>
:ET