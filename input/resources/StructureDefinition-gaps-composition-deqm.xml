<?xml version="1.0" encoding="UTF-8"?>
<StructureDefinition
    xmlns="http://hl7.org/fhir">
    <id value="gaps-composition-deqm"/>
    <url value="http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/gaps-composition-deqm"/>
    <name value="DEQMGapsInCareCompositionProfile"/>
    <title value="DEQM Gaps In Care Composition Profile"/>
    <status value="active"/>
    <fhirVersion value="4.0.1"/>
    <mapping>
        <identity value="workflow"/>
        <uri value="http://hl7.org/fhir/workflow"/>
        <name value="Workflow Pattern"/>
    </mapping>
    <mapping>
        <identity value="rim"/>
        <uri value="http://hl7.org/v3"/>
        <name value="RIM Mapping"/>
    </mapping>
    <mapping>
        <identity value="cda"/>
        <uri value="http://hl7.org/v3/cda"/>
        <name value="CDA (R2)"/>
    </mapping>
    <mapping>
        <identity value="fhirdocumentreference"/>
        <uri value="http://hl7.org/fhir/documentreference"/>
        <name value="FHIR DocumentReference"/>
    </mapping>
    <mapping>
        <identity value="w5"/>
        <uri value="http://hl7.org/fhir/fivews"/>
        <name value="FiveWs Pattern Mapping"/>
    </mapping>
    <kind value="resource"/>
    <abstract value="false"/>
    <type value="Composition"/>
    <baseDefinition value="http://hl7.org/fhir/StructureDefinition/Composition"/>
    <derivation value="constraint"/>
    <differential>
        <element id="Composition">
            <path value="Composition"/>
        </element>
        <element id="Composition.type">
            <path value="Composition.type"/>
            <fixedCodeableConcept>
                <coding>
                    <system value="http://hl7.org/fhir/us/davinci-deqm/CodeSystem/gaps-doc-type"/>
                    <code value="gaps-doc"/>
                    <display value="Gaps in Care Report"/>
                </coding>
            </fixedCodeableConcept>
        </element>
        <element id="Composition.subject">
            <path value="Composition.subject"/>
            <min value="1"/>
            <type>
                <code value="Reference"/>
                <targetProfile value="http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-patient"/>
            </type>
        </element>
        <element id="Composition.date">
            <path value="Composition.date"/>
            <short value="The time the gap report was run"/>
        </element>
        <element id="Composition.title">
            <path value="Composition.title"/>
            <type>
                <code value="string"/>
            </type>
            <fixedString value="Care Gaps Report"/>
        </element>
        <element id="Composition.custodian">
            <path value="Composition.custodian"/>
            <short value="Producers have the obligations to either keep the care gaps report for future reference or have the capability to reproduce (exact time stamps as it was originally generated) for auditing purpose.  In an ideal FHIR environment, you would be able to use version histories to recreate a snapshot at a point in time when the report was generated, but not sure how it runs and will be challenging in real world..  From providers perspective, archiving things, because memberships could change. Cannot necessarily re-generate the exact same report at the time it was originally created.   Keeping the custodian is useful to support the use cases, but not making it required in the spec. Since different states may have different regulations. E.g., CA has a stricter regulation. "/>
        </element>
        <element id="Composition.section">
            <path value="Composition.section"/>
            <short value="Must contain at least one section, each section corresponds to a measure"/>
            <min value="1"/>
        </element>
        <element id="Composition.section.title">
            <path value="Composition.section.title"/>
            <short value="The would be the measure name (referenced in focus)"/>
        </element>
        <element id="Composition.section.focus">
            <path value="Composition.section.focus"/>
            <min value="1"/>
            <type>
                <code value="Reference"/>
                <targetProfile value="http://hl7.org/fhir/us/davinci-deqm/StructureDefinition/gaps-indv-measurereport-deqm"/>
            </type>
        </element>
        <element id="Composition.section.entry">
            <path value="Composition.section.entry"/>
            <short value="The entry is optional. Will only return DetectedIssue when there is an open gap."/>
            <type>
                <code value="Reference"/>
                <profile value="http://hl7.org/fhir/us/davincigaps/gaps-detectedIssue-deqm"/>
            </type>
        </element>
    </differential>
</StructureDefinition>
